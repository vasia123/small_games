import{_ as E}from"./nuxt-link.d31b60c2.js";import{_ as M}from"./TitleCard.vue.1933d09b.js";import{_ as V}from"./ModalError.vue.68c0c190.js";import{_ as j}from"./ModalDialog.vue.3f1ff245.js";import{f as A,g as F,r as d,o as r,c,b as l,w as s,i as t,F as w,j as x,k as T,a,C as G,t as I,m as C,d as _,n as L}from"./entry.0534d1ea.js";import{u as U}from"./useFirebaseDB.5baf7228.js";const q={key:0},Q={class:"overflow-x-auto w-full"},S={class:"mb-1"},z=["src"],H=["onClick"],J={key:1},K={class:"flex justify-between mt-8"},O=a("h3",{class:"font-bold text-lg"},"Подтверждение удаления",-1),P=a("p",{class:"py-4"},"Вы уверены, что хотите удалить этот раунд?",-1),W=a("label",{for:"delete-modal",class:"btn"},"Отмена",-1),X=["disabled"],Y={key:0,class:"loading loading-spinner"},le=A({__name:"index",setup(Z){const h=F(),{gamesAndQuestionsCol:y}=U();let o;Array.isArray(h.params.gameId)?o=h.params.gameId.join(""):o=h.params.gameId;const u=d(""),k=d(""),i=d([]),f=d(!1);(async()=>{try{const e=x(y,o),m=await T(e);if(m.exists()){const n=m.data();k.value=n.name,i.value=n.rounds}else u.value="Игра не найдена"}catch(e){e instanceof Error?u.value=e.message:console.error("Unexpected error",e)}})();const b=d(!1);let p=-1;const D=e=>{p=e,b.value=!0},N=async()=>{if(p>-1){f.value=!0;try{const e=i.value.splice(p,1),m=x(y,o);await L(m,{rounds:e}),i.value=e}catch(e){e instanceof Error?u.value=e.message:console.error("Unexpected error",e)}f.value=!1,b.value=!1,p=-1}};return(e,m)=>{const n=E,R=M,$=V,B=j;return r(),c(w,null,[l(R,{title:`Туры игры: ${t(k)}`},{default:s(()=>[t(i).length>0?(r(),c("div",q,[a("div",Q,[(r(!0),c(w,null,G(t(i),(g,v)=>(r(),c("div",{key:g.name,class:"my-2 p-2"},[a("div",S,I(g.name),1),g.image?(r(),c("img",{key:0,src:g.image,alt:"Изображение тура"},null,8,z)):C("",!0),l(n,{class:"btn btn-primary mr-2",to:"/admin/games/"+t(o)+"/rounds/"+v+"-edit"},{default:s(()=>[_("Редактировать")]),_:2},1032,["to"]),l(n,{class:"btn btn-accent mr-2",to:"/admin/games/"+t(o)+"/rounds/"+v+"-questions"},{default:s(()=>[_("Вопросы")]),_:2},1032,["to"]),a("button",{class:"btn btn-error mr-2",onClick:te=>D(v)}," Удалить ",8,H)]))),128))])])):(r(),c("div",J,"Нет туров")),a("div",K,[l(n,{class:"btn btn-ghost",to:"/admin/"},{default:s(()=>[_("к списку игр")]),_:1}),l(n,{class:"btn btn-primary",to:"/admin/games/"+t(o)+"/rounds/new"},{default:s(()=>[_("Добавить тур")]),_:1},8,["to"])])]),_:1},8,["title"]),l($,{message:t(u)},null,8,["message"]),l(B,{"modal-id":"delete-modal","show-modal":t(b)},{title:s(()=>[O]),content:s(()=>[P]),actions:s(()=>[W,a("button",{class:"btn btn-error",disabled:t(f),onClick:N},[t(f)?(r(),c("span",Y)):C("",!0),_(" Удалить ")],8,X)]),_:1},8,["show-modal"])],64)}}});export{le as default};
